# SQL-Projects

## 1. Pizza Sales Project

![img](https://github.com/nadeem-ahmed-git/SQL-Projects/blob/main/Pizza%20Sales%20Project/Pizza%20Sales%20data%20model.png)

This project involved creating a database schema for a pizza sales system and then using SQL queries to analyze sales data. Here's a breakdown of what I accomplished:

Database Creation:
  •	Created a database named pizzahut.
  •	Defined two tables: 
  o	orders: Stores information about individual orders, including order ID, date, and time. (Primary key: order_id)
  o	order_details: Captures details about each pizza ordered within an order, including order ID, pizza ID, and quantity. (Primary key: order_details_id)

Basic Analysis:
  •	Retrieved the total number of orders placed using COUNT function.
  •	Calculated the total revenue generated by summing the product of pizza price and quantity across pizzas and order details, rounded to two decimal places.
  •	Identified the pizza with the highest price by joining pizza_types and pizzas tables, ordering by price descending, and selecting the top row.
  •	Determined the most frequently ordered pizza size by grouping pizzas by size, counting occurrences, and ordering by count in descending order.
  •	Found the category-wise distribution of pizzas by grouping pizza_types by category and counting the number of pizzas in each category.

Intermediate Analysis:
  •	Joined the tables to find the total quantity of pizzas ordered within each category by grouping by category and summing the quantity.
  •	Analyzed the distribution of orders by hour by extracting the hour from the order time, grouping by hour, and counting the number of orders for each hour.
  •	Identified the top 5 most ordered pizza types along with their total quantities by joining tables, grouping by pizza name, summing quantities, and ordering by quantity descending with a limit of 5.
  •	Calculated the average number of pizzas ordered per day by grouping orders by date, summing daily order quantities, averaging them, and rounding to the nearest whole number.
  •	Determined the top 3 revenue-generating pizzas by joining tables, grouping by pizza name, summing the product of price and quantity, ordering by revenue descending, and limiting to 3.

Advanced Analysis:
  •	Calculated the percentage contribution of each pizza type's revenue to the total revenue by joining tables, grouping by category, calculating the revenue share as a percentage, and rounding to two decimal places.
  •	Analyzed the cumulative revenue generated over time by calculating the total revenue for each date along with a running total of revenue across all previous dates.
  •	Identified the top 3 revenue-generating pizza types within each category by joining tables, grouping by category and name, calculating revenue, ranking pizzas within each category by revenue descending, and selecting the top 3 for each category.

  ## 2. Diabetes Prediction (Internship)

  ![img](https://github.com/nadeem-ahmed-git/SQL-Projects/blob/main/Diabetes%20Prediction/Diabetes%20prediction.png)

  This project focused on diabetes prediction, where I created and managed a database schema to store patient data effectively. Using SQL queries, I analyzed patient information by retrieving Patient_ids and ages, calculating averages like BMI and HbA1c levels, ranking data based on blood glucose levels, updating records for certain conditions like age and smoking history, inserting new patient data, creating a view to display specific patient information, and ensuring data integrity with unique constraints.

  Insights:
•	Analyzed patient data to retrieve Patient_ids and ages of all patients.
•	Selected female patients over 40 years old and their details.
•	Calculated the average BMI of patients.
•	Listed patients in descending order of blood glucose levels.
•	Identified patients with hypertension and diabetes.
•	Determined the number of patients with heart disease.
•	Grouped patients by smoking history and counted smokers and non-smokers.
•	Retrieved Patient_ids of patients with a BMI higher than the average.
•	Found the patients with the highest and lowest HbA1c levels.
•	Ranked patients by blood glucose level within gender groups.
•	Updated smoking history for patients over 50 to "Ex-smoker."
•	Inserted a new patient into the database with sample data.
•	Deleted patients with heart disease from the database.
•	Found patients with hypertension but not diabetes using the EXCEPT operator.
•	Defined a unique constraint on the "patient_id" column to ensure uniqueness.
•	Created a view displaying Patient_ids, ages, and BMI of patients.a



